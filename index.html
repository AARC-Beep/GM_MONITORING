<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>THRI – Daily Routine Dashboard</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxwyy2tSyswRgQ-RZh_zS3e2vrH5tG-H2FB4tnUWShd-eN-sHIlaZEHeyUJHtyc82WWlA/exec";
</script>
</head>

<body class="bg-gray-100 font-sans">

<!-- === Auto Refresh Notice === -->
<div id="refreshNotice" 
     style="background:#021827;color:#fff;text-align:center;padding:6px;font-size:14px;font-family:Arial;border-bottom:2px solid gold;">
  🔄 Data automatically refreshes every <span id="refreshInterval">15</span> seconds.
</div>

<!-- === Header === -->
<header class="bg-blue-900 text-white py-4 shadow-md">
  <h1 class="text-center text-2xl font-bold">TIWALA HUMAN RESOURCES INC. — Manning Dashboard</h1>
</header>

<!-- === Sidebar === -->
<div class="flex">
  <nav class="w-64 bg-blue-800 text-white min-h-screen p-4">
    <ul class="space-y-3">
      <li><button onclick="showSection('vesselJoin')" class="w-full text-left">🛳 Vessel Join</button></li>
      <li><button onclick="showSection('arrivals')" class="w-full text-left">✈ Arrivals</button></li>
      <li><button onclick="showSection('updates')" class="w-full text-left">📰 Updates</button></li>
      <li><button onclick="showSection('memo')" class="w-full text-left">📋 Memo</button></li>
      <li><button onclick="showSection('training')" class="w-full text-left">🎓 Training</button></li>
      <li><button onclick="showSection('pni')" class="w-full text-left">⚕ PNI</button></li>
      <li><button onclick="showSection('blackboard')" class="w-full text-left">💬 Blackboard / Chat</button></li>
    </ul>
  </nav>

  <!-- === Main Content === -->
  <main class="flex-1 p-6">

    <!-- Vessel Join -->
    <section id="vesselJoin" class="hidden">
      <h2 class="text-xl font-semibold mb-4">🛳 Vessel Join</h2>
      <form id="vesselJoinForm" class="space-y-2">
        <input class="border p-2 w-full" placeholder="Vessel" name="vessel" required>
        <input class="border p-2 w-full" placeholder="Port" name="port" required>
        <input class="border p-2 w-full" placeholder="No. of Crew" name="noCrew" type="number">
        <input class="border p-2 w-full" placeholder="Rank" name="rank">
        <input class="border p-2 w-full" type="date" name="date">
        <input class="border p-2 w-full" placeholder="Flight" name="flight">
        <button type="submit" class="bg-blue-700 text-white px-4 py-2 rounded">Save</button>
      </form>
    </section>

    <!-- Arrivals -->
    <section id="arrivals" class="hidden">
      <h2 class="text-xl font-semibold mb-4">✈ Arrivals</h2>
      <form id="arrivalsForm" class="space-y-2">
        <input class="border p-2 w-full" placeholder="Vessel" name="vessel">
        <input class="border p-2 w-full" placeholder="Port" name="port">
        <input class="border p-2 w-full" placeholder="No. of Crew" name="noCrew" type="number">
        <input class="border p-2 w-full" placeholder="Rank" name="rank">
        <input class="border p-2 w-full" type="date" name="date">
        <input class="border p-2 w-full" placeholder="Flight" name="flight">
        <button type="submit" class="bg-blue-700 text-white px-4 py-2 rounded">Save</button>
      </form>
    </section>

    <!-- Updates -->
    <section id="updates" class="hidden">
      <h2 class="text-xl font-semibold mb-4">📰 Updates</h2>
      <form id="updatesForm" class="space-y-2">
        <input class="border p-2 w-full" placeholder="Title" name="title">
        <textarea class="border p-2 w-full" placeholder="Details" name="details"></textarea>
        <input class="border p-2 w-full" type="date" name="date">
        <button type="submit" class="bg-blue-700 text-white px-4 py-2 rounded">Save</button>
      </form>
    </section>

    <!-- Memo -->
    <section id="memo" class="hidden">
      <h2 class="text-xl font-semibold mb-4">📋 Memo</h2>
      <form id="memoForm" class="space-y-2">
        <input class="border p-2 w-full" placeholder="Title" name="title">
        <textarea class="border p-2 w-full" placeholder="Details" name="details"></textarea>
        <input class="border p-2 w-full" type="date" name="date">
        <button type="submit" class="bg-blue-700 text-white px-4 py-2 rounded">Save</button>
      </form>
    </section>

    <!-- Training -->
    <section id="training" class="hidden">
      <h2 class="text-xl font-semibold mb-4">🎓 Training</h2>
      <form id="trainingForm" class="space-y-2">
        <input class="border p-2 w-full" placeholder="Subject" name="subject">
        <textarea class="border p-2 w-full" placeholder="Details" name="details"></textarea>
        <input class="border p-2 w-full" type="date" name="date">
        <button type="submit" class="bg-blue-700 text-white px-4 py-2 rounded">Save</button>
      </form>
    </section>

    <!-- PNI -->
    <section id="pni" class="hidden">
      <h2 class="text-xl font-semibold mb-4">⚕ PNI</h2>
      <form id="pniForm" class="space-y-2">
        <input class="border p-2 w-full" placeholder="Subject" name="subject">
        <textarea class="border p-2 w-full" placeholder="Details" name="details"></textarea>
        <input class="border p-2 w-full" type="date" name="date">
        <button type="submit" class="bg-blue-700 text-white px-4 py-2 rounded">Save</button>
      </form>
    </section>

    <!-- Blackboard / Chat -->
    <section id="blackboard" class="hidden">
      <h2 class="text-xl font-semibold mb-4">💬 Blackboard / Chat</h2>
      <textarea id="chatInput" class="border p-2 w-full h-24" placeholder="Write a note..."></textarea>
      <button onclick="postChat()" class="bg-green-600 text-white px-4 py-2 rounded mt-2">Post</button>
      <div id="chatBoard" class="mt-4 p-3 bg-white rounded shadow max-h-80 overflow-y-auto"></div>
    </section>

    <!-- Quick Links -->
    <section id="quick-links" class="p-4 bg-gray-50 rounded-2xl shadow mt-6">
      <h2 class="text-lg font-semibold text-gray-800 mb-3">🌐 Quick Links</h2>
      <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
        <a href="https://www.flightaware.com/live/airport/MNL" target="_blank" class="block text-center bg-blue-600 text-white py-2 rounded-xl hover:bg-blue-700 transition">✈ FlightAware (MNL)</a>
        <a href="https://www.msn.com/en-ph/news" target="_blank" class="block text-center bg-green-600 text-white py-2 rounded-xl hover:bg-green-700 transition">📰 MSN Philippines</a>
        <a href="https://zoom.earth/" target="_blank" class="block text-center bg-sky-600 text-white py-2 rounded-xl hover:bg-sky-700 transition">🌦 Zoom Earth (Weather)</a>
        <a href="https://dmw.gov.ph" target="_blank" class="block text-center bg-yellow-600 text-white py-2 rounded-xl hover:bg-yellow-700 transition">🧭 DMW</a>
        <a href="https://owwa.gov.ph" target="_blank" class="block text-center bg-orange-600 text-white py-2 rounded-xl hover:bg-orange-700 transition">🤝 OWWA</a>
        <a href="https://marina.gov.ph" target="_blank" class="block text-center bg-indigo-600 text-white py-2 rounded-xl hover:bg-indigo-700 transition">⚓ MARINA</a>
      </div>
    </section>
  </main>
</div>

<script>
function showSection(id){
  document.querySelectorAll("main section").forEach(s=>s.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

// === Generic form posting ===
document.querySelectorAll("form").forEach(f=>{
  f.addEventListener("submit", async e=>{
    e.preventDefault();
    const formData = Object.fromEntries(new FormData(f).entries());
    formData.sheet = f.id.replace("Form","");
    const res = await fetch(SCRIPT_URL,{
      method:"POST",
      body:JSON.stringify(formData),
      headers:{"Content-Type":"application/json"}
    });
    const data = await res.json();
    alert("Saved!");
    f.reset();
  });
});

// === Blackboard Chat ===
async function postChat(){
  const txt=document.getElementById("chatInput").value.trim();
  if(!txt)return;
  const entry={sheet:"Memo",title:"Blackboard",details:txt,date:new Date().toISOString().split("T")[0]};
  await fetch(SCRIPT_URL,{method:"POST",body:JSON.stringify(entry),headers:{"Content-Type":"application/json"}});
  document.getElementById("chatInput").value="";
  loadChat();
}
async function loadChat(){
  const res=await fetch(SCRIPT_URL+"?sheet=Memo");
  const rows=await res.json();
  const chat=document.getElementById("chatBoard");
  chat.innerHTML=rows.slice(1).reverse().map(r=>`<div class='border-b py-1'><b>${r[1]}</b>: ${r[2]}</div>`).join("");
}
setInterval(()=>{loadChat();blinkNotice();},15000);
function blinkNotice(){const n=document.getElementById("refreshNotice");n.style.background="#054d8c";setTimeout(()=>{n.style.background="#021827"},600);}
</script>

</body>
</html>
